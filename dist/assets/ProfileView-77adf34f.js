import{o,c,a,b as d,w as m,d as h,t as n,e as l,f as u,g as f,r as p,h as _}from"./index-363b435c.js";const v={href:"#"},b={className:"modificar__caja"},y={className:"modificar__avatar"},g=["src"],U=["type","value"],k={key:0,className:"modificar__caja__informativo1--visible"},C=["value"],V={key:1,className:"modificar__caja__informativo1--visible"},w=a("section",{className:"modificar__boton"},[a("input",{type:"submit",className:"modificar__boton__opcion modificar__boton__opcion--modificar",value:"Modificar",readonly:""})],-1),$={data(){return{textPass:"",textCorreo:this.correo,textFecha:this.fecha_nacimiento,expresionUsuario:/^[a-zA-Z]((\.|_|-)?[a-zA-Z0-9]+){3}$/,expresionPass:/^(?=\w*\d)(?=\w*[A-Z])(?=\w*[a-z])\S{8,16}$/,expresionCorreo:/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*@[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[.][a-zA-Z]{2,5}$/,passValido:!1,correoValido:!0,fechaValida:!0,mensajeError1:"Necesitas tener más de 4 caracteres y sin espacios",mensajeError2:"Se necesita entre 8-16 caracteres, mínimo un dígito, mayúscula y minúscula",mensajeError3:"Necesitas tener un patrón correcto (ej: usuario@gmail.com)",mensajeError4:"Se necesita una fecha válida y ser mayor de 13 años",hayErrores:!1,inputType:"password",icon:"visibility",formData:{id:"",name:"",password:"",fecha_nacimiento:"",email:"",avatar:""}}},methods:{cambiarTextoPass(s){this.textPass=s.target.value,this.expresionPass.test(this.textPass)?this.passValido=!0:this.passValido=!1},cambiarTextoCorreo(s){this.textCorreo=s.target.value,this.expresionCorreo.test(this.textCorreo)?this.correoValido=!0:this.correoValido=!1},cambiarTextoFecha(s){if(this.textFecha=s.target.value,this.textFecha){let i=new Date().getFullYear(),t=this.textFecha.substr(0,4),r=i-t;r>13&&r<=120?this.fechaValida=!0:this.fechaValida=!1}else this.fechaValida=!1},check(){this.passValido&&this.fechaValida&&this.correoValido&&(this.$emit("check"),this.lanzar_modificar_cuenta())},modificar(){this.check(),this.$emit("modificar"),(!this.passValido||!this.correoValido||!this.fechaValida)&&(this.hayErrores=!0)},async lanzar_modificar_cuenta(){this.formData={name:this.nombre,password:this.textPass,email:this.correo,fecha_nacimiento:this.textFecha,avatar:this.avatar,id:this.idUsuario};const e=new TextEncoder().encode(this.formData.password),i=await crypto.subtle.digest("SHA-1",e),t=Array.from(new Uint8Array(i)).map(r=>r.toString(16).padStart(2,"0")).join("");this.formData.password=t;try{const r=await f.put("https://crev-server.onrender.com/api/v1/autorizacion/users/"+this.formData.id,this.formData,{withCredentials:!0});window.location.reload()}catch(r){console.error(r)}},toggleVisibility(){this.inputType=this.inputType==="password"?"text":"password",this.icon=this.icon==="visibility"?"visibility_off":"visibility"}}},F=Object.assign($,{__name:"Modificar_cuenta",props:{nombre:{type:String,required:!0},correo:{type:String,required:!0},fecha_nacimiento:{type:String,required:!0},avatar:{type:String,required:!0},idUsuario:{type:String,required:!0}},setup(s){return(e,i)=>{const t=p("tittle");return o(),c("div",null,[a("div",{className:"fondo",onClick:i[0]||(i[0]=r=>e.$emit("cerrar"))}),a("form",{className:"modificar",onSubmit:i[5]||(i[5]=u((...r)=>e.modificar&&e.modificar(...r),["prevent"]))},[a("a",v,[a("span",{className:"material-symbols-outlined iniciar_sesion__cerrar",onClick:i[1]||(i[1]=r=>e.$emit("cerrar"))},"close")]),d(t,{className:"modificar__titulo"},{default:m(()=>[h("Modificar")]),_:1}),a("section",b,[a("div",y,[a("img",{className:"modificar__avatar__imagen",src:s.avatar},null,8,g)]),a("input",{type:e.inputType,onInput:i[2]||(i[2]=(...r)=>e.cambiarTextoPass&&e.cambiarTextoPass(...r)),class:"modificar__caja__elemento",placeholder:"Contraseña...",value:e.textPass},null,40,U),a("span",{class:"material-symbols-outlined",onClick:i[3]||(i[3]=(...r)=>e.toggleVisibility&&e.toggleVisibility(...r))},n(e.icon),1),!e.passValido&&e.hayErrores?(o(),c("div",k,n(e.mensajeError2),1)):l("",!0),a("input",{onInput:i[4]||(i[4]=(...r)=>e.cambiarTextoFecha&&e.cambiarTextoFecha(...r)),className:"modificar__caja__elemento",type:"date",value:e.textFecha},null,40,C),!e.fechaValida&&e.hayErrores?(o(),c("div",V,n(e.mensajeError4),1)):l("",!0)]),w],32)])}}}),N={key:0,class:"cuerpo cuerpo--perfil"},A={class:"cuerpo--perfil__avatar"},j=["src"],P={class:"cuerpo--perfil__nombre"},S={class:"cuerpo--perfil__nombre__respuesta"},E={class:"cuerpo--perfil__correo"},M=a("div",{class:"cuerpo--perfil__correo__pregunta"},"Correo Electrónico",-1),T={class:"cuerpo--perfil__correo__respuesta"},z={class:"cuerpo--perfil__fecha"},D=a("div",{class:"cuerpo--perfil__fecha__pregunta"},"Fecha de nacimiento",-1),Z={class:"cuerpo--perfil__fecha__respuesta"},q={key:1},B={data(){return{modificar:!1,checkForm:!1,mostrarPartidos:!1,nombre:"",avatar:"https://images.pexels.com/photos/5609026/pexels-photo-5609026.jpeg?auto=compress&cs=tinysrgb&w=600",correo:"",fecha_nacimiento:"",idUsuarioActual:"",cambios:!1}},mounted(){this.llamarApiUsuario()},methods:{producirCambios(){this.cambios=!this.cambios},cambiarModificar(){this.modificar=!this.modificar},toggleCheck(){this.checkForm=!this.checkForm},guardarModificado(){this.checkForm&&(this.modificar=!1,this.checkForm=!1)},toggleMostrarPartidos(){this.mostrarPartidos=!this.mostrarPartidos},async llamarApiUsuario(){this.idUsuarioActual=this.$route.params.id;const e=await(await fetch("https://crev-server.onrender.com/api/v1/users/"+this.idUsuarioActual)).json();this.resultsUsuario=e,this.nombre=this.resultsUsuario.name,this.correo=this.resultsUsuario.email,this.fecha_nacimiento=this.resultsUsuario.fecha_nacimiento}}},I=Object.assign(B,{__name:"Profile",props:{idUsuario:{type:String,required:!0}},setup(s){return(e,i)=>e.nombre?(o(),c("main",N,[a("section",A,[a("img",{class:"cuerpo--perfil__avatar__imagen",src:e.avatar},null,8,j),s.idUsuario==e.idUsuarioActual?(o(),c("a",{key:0,onClick:i[0]||(i[0]=(...t)=>e.cambiarModificar&&e.cambiarModificar(...t)),class:"cuerpo--perfil__avatar__editar"}," Editar Perfil ")):l("",!0)]),a("section",P,[a("div",S,"@"+n(e.nombre),1)]),a("section",E,[M,a("div",T,n(e.correo),1)]),a("section",z,[D,a("div",Z,n(e.fecha_nacimiento),1)]),e.modificar&&s.idUsuario==e.idUsuarioActual?(o(),_(F,{key:0,onCerrar:e.cambiarModificar,modificar:e.modificar,onCheck:e.toggleCheck,checkForm:e.checkForm,onModificar:e.guardarModificado,correo:e.correo,nombre:e.nombre,fecha_nacimiento:e.fecha_nacimiento,avatar:e.avatar,idUsuario:s.idUsuario,onCambiar:e.producirCambios},null,8,["onCerrar","modificar","onCheck","checkForm","onModificar","correo","nombre","fecha_nacimiento","avatar","idUsuario","onCambiar"])):l("",!0)])):(o(),c("main",q," No se ha encontrado el usuario. "))}}),H={__name:"ProfileView",props:{idUsuario:{type:String,required:!0}},setup(s){return(e,i)=>(o(),c("main",null,[d(I,{idUsuario:s.idUsuario,search:e.search},null,8,["idUsuario","search"])]))}};export{H as default};
